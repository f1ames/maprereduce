"use strict";!function(a){var b=function(a,b,c,d){if(!(a instanceof Function))throw new Error("mapFn should be a function, e.g. function(key, value) {...}");if(!(b instanceof Function))throw new Error("reduceFn should be a function, e.g. function(key, values) {...}");if(!(c instanceof Function))throw new Error("rereduceFn should be a function, e.g. function(value1, value2) {...}");if(!(void 0===d||null===d||d instanceof Object&&!d instanceof Array))throw new Error("initialResult should be instance of Object");this.tmp={},this.result=d||{},this.mapFn=a,this.reduceFn=b,this.rereduceFn=c};b.prototype={feed:function(a){var b=this;return this.tmp={},a.forEach(function(a){var c=b.mapFn(a);c instanceof Array?c.forEach(function(c){b._emit(c,a)}):b._emit(c,a)}),this._reduce(this.tmp),this},_emit:function(a,b){void 0!==a&&null!==a&&(this.tmp[a]||(this.tmp[a]=[]),this.tmp[a].push(b))},_reduce:function(a){for(var b in a)this.result[b]=this.result[b]?this.rereduceFn(this.result[b],this.reduceFn(a[b])):this.reduceFn(a[b])}},module&&module.exports?module.exports=b:define?define("MapReduce",function(){return b}):a.MapReduce=b}(this);